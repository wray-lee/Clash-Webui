import{r as E,R as p,k as f,j as a,s as F,i as I,c as Z,b as c,l as ee,n as W,o as A,q as te,e as V,t as ne,h as B,v as ae,w as re,x as _,f as le,y as oe,z as se,A as ie,D as ce,u as de,C as ue,E as x,B as y,G as pe,H as he}from"./index-90d9ad66.js";import{r as fe}from"./logs-6337a0fe.js";import{S as w}from"./Select-85e5e596.js";import{R as ge}from"./rotate-cw-e54bba7f.js";function N(){return N=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},N.apply(this,arguments)}function ve(e,o){if(e==null)return{};var l=me(e,o),n,t;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function me(e,o){if(e==null)return{};var l={},n=Object.keys(e),t,r;for(r=0;r<n.length;r++)t=n[r],!(o.indexOf(t)>=0)&&(l[t]=e[t]);return l}var z=E.forwardRef(function(e,o){var l=e.color,n=l===void 0?"currentColor":l,t=e.size,r=t===void 0?24:t,d=ve(e,["color","size"]);return p.createElement("svg",N({ref:o,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),p.createElement("polyline",{points:"8 17 12 21 16 17"}),p.createElement("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),p.createElement("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"}))});z.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};z.displayName="DownloadCloud";const be=z;function j(){return j=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},j.apply(this,arguments)}function ye(e,o){if(e==null)return{};var l=we(e,o),n,t;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function we(e,o){if(e==null)return{};var l={},n=Object.keys(e),t,r;for(r=0;r<n.length;r++)t=n[r],!(o.indexOf(t)>=0)&&(l[t]=e[t]);return l}var L=E.forwardRef(function(e,o){var l=e.color,n=l===void 0?"currentColor":l,t=e.size,r=t===void 0?24:t,d=ye(e,["color","size"]);return p.createElement("svg",j({ref:o,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),p.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),p.createElement("polyline",{points:"16 17 21 12 16 7"}),p.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});L.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};L.displayName="LogOut";const ke=L;function P(){return P=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},P.apply(this,arguments)}function Ce(e,o){if(e==null)return{};var l=Oe(e,o),n,t;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function Oe(e,o){if(e==null)return{};var l={},n=Object.keys(e),t,r;for(r=0;r<n.length;r++)t=n[r],!(o.indexOf(t)>=0)&&(l[t]=e[t]);return l}var $=E.forwardRef(function(e,o){var l=e.color,n=l===void 0?"currentColor":l,t=e.size,r=t===void 0?24:t,d=Ce(e,["color","size"]);return p.createElement("svg",P({ref:o,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},d),p.createElement("polyline",{points:"3 6 5 6 21 6"}),p.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});$.propTypes={color:f.string,size:f.oneOfType([f.string,f.number])};$.displayName="Trash2";const _e=$,{useState:xe,useRef:Se,useEffect:Ne,useCallback:je}=I;function Pe(e){return a("input",{className:F.input,...e})}function Ee({value:e,...o}){const[l,n]=xe(e),t=Se(e);Ne(()=>{t.current!==e&&n(e),t.current=e},[e]);const r=je(d=>n(d.target.value),[n]);return a("input",{className:F.input,value:l,onChange:r,...o})}const Ie="_root_165du_1",ze="_section_165du_2",Le="_wrapSwitch_165du_26",$e="_sep_165du_32",Te="_label_165du_45",i={root:Ie,section:ze,wrapSwitch:Le,sep:$e,label:Te},Re="_fieldset_1ghjp_1",Me="_input_1ghjp_9",De="_cnt_1ghjp_9",S={fieldset:Re,input:Me,cnt:De};function We({OptionComponent:e,optionPropsList:o,selectedIndex:l,onChange:n}){const t=Z("visually-hidden",S.input),r=d=>{n(d.target.value)};return a("fieldset",{className:S.fieldset,children:o.map((d,b)=>c("label",{children:[a("input",{type:"radio",checked:l===b,name:"selection",value:b,"aria-labelledby":"traffic chart type "+b,onChange:r,className:t}),a("div",{className:S.cnt,children:a(e,{...d})})]},b))})}const{useMemo:Ae}=I,Fe={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},U=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Ve=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Be=U;function Ue({id:e}){const o=ee.read(),l=Ae(()=>({labels:Be,datasets:[{...W,...A[e].up,data:U},{...W,...A[e].down,data:Ve}]}),[e]),n="chart-"+e;return te(o.Chart,n,l,null,Fe),a("div",{style:{width:100,padding:5},children:a("canvas",{id:n})})}const{useEffect:G,useState:Ge,useCallback:v,useRef:He}=I,qe=[{id:0},{id:1},{id:2},{id:3}],Je=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Ke=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],Qe=[["zh","中文"],["en","English"]],Xe=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],Ye=[["gVisor","gVisor"],["System","System"]],Ze=e=>({configs:ne(e),apiConfig:B(e)}),et=e=>({selectedChartStyleIndex:pe(e),latencyTestUrl:he(e),apiConfig:B(e)}),tt=V(et)(at),it=V(Ze)(nt);function nt({dispatch:e,configs:o,apiConfig:l}){return G(()=>{e(ae(l))},[e,l]),a(tt,{configs:o})}function at({dispatch:e,configs:o,selectedChartStyleIndex:l,latencyTestUrl:n,apiConfig:t}){const[r,d]=Ge(o),b=He(o);G(()=>{b.current!==o&&d(o),b.current=o},[o]);const H=v(()=>{e(re("apiConfig"))},[e]),k=v((s,u)=>{d({...r,[s]:u})},[r]),T=v((s,u)=>{const g={...r.tun,[s]:u};d({...r,tun:{...g}})},[r]),m=v(({name:s,value:u})=>{switch(s){case"mode":case"log-level":case"allow-lan":case"sniffing":k(s,u),e(_(t,{[s]:u})),s==="log-level"&&fe({...t,logLevel:u});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(u!==""){const g=parseInt(u,10);if(g<0||g>65535)return}k(s,u);break;case"enable":case"stack":T(s,u),e(_(t,{tun:{[s]:u}})).then(()=>{le(t)});break;default:return}},[t,e,k,T]),q=v(s=>m(s.target),[m]),{selectChartStyleIndex:J,updateAppConfig:R}=oe(),M=v(s=>{const u=s.target,{name:g,value:D}=u;switch(g){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const O=parseInt(D,10);if(O<0||O>65535)return;e(_(t,{[g]:O}));break}case"latencyTestUrl":{R(g,D);break}default:throw new Error(`unknown input name ${g}`)}},[t,e,R]),K=v(()=>{e(se(t))},[t,e]),Q=v(()=>{e(ie(t))},[t,e]),X=v(()=>{e(ce(t))},[t,e]),{t:h,i18n:C}=de(),Y=C.language&&C.language.indexOf("zh")>-1?"zh":"en";return c("div",{children:[a(ue,{title:h("Config")}),c("div",{className:i.root,children:[Ke.map(s=>r[s.key]!==void 0?c("div",{children:[a("div",{className:i.label,children:s.label}),a(Pe,{name:s.key,value:r[s.key],onChange:q,onBlur:M})]},s.key):null),c("div",{children:[a("div",{className:i.label,children:"Mode"}),a(w,{options:Xe,selected:r.mode,onChange:s=>m({name:"mode",value:s.target.value})})]}),c("div",{children:[a("div",{className:i.label,children:"Log Level"}),a(w,{options:Je,selected:r["log-level"],onChange:s=>m({name:"log-level",value:s.target.value})})]}),c("div",{children:[a("div",{className:i.label,children:h("allow_lan")}),a("div",{className:i.wrapSwitch,children:a(x,{name:"allow-lan",checked:r["allow-lan"],onChange:s=>m({name:"allow-lan",value:s})})})]}),c("div",{children:[a("div",{className:i.label,children:h("tls_sniffing")}),a("div",{className:i.wrapSwitch,children:a(x,{name:"sniffing",checked:r.sniffing,onChange:s=>m({name:"sniffing",value:s})})})]})]}),a("div",{className:i.sep,children:a("div",{})}),c("div",{className:i.section,children:[c("div",{children:[a("div",{className:i.label,children:h("enable_tun_device")}),a("div",{className:i.wrapSwitch,children:a(x,{checked:r.tun.enable,onChange:s=>m({name:"enable",value:s})})})]}),c("div",{children:[a("div",{className:i.label,children:"TUN IP Stack"}),a(w,{options:Ye,selected:r.tun.stack,onChange:s=>m({name:"stack",value:s.target.value})})]})]}),a("div",{className:i.sep,children:a("div",{})}),c("div",{className:i.section,children:[c("div",{children:[a("div",{className:i.label,children:"Reload"}),a(y,{start:a(ge,{size:16}),label:h("reload_config_file"),onClick:K})]}),c("div",{children:[a("div",{className:i.label,children:"GEO Databases"}),a(y,{start:a(be,{size:16}),label:h("update_geo_databases_file"),onClick:Q})]}),c("div",{children:[a("div",{className:i.label,children:"FakeIP"}),a(y,{start:a(_e,{size:16}),label:h("flush_fake_ip_pool"),onClick:X})]})]}),a("div",{className:i.sep,children:a("div",{})}),c("div",{className:i.section,children:[c("div",{children:[a("div",{className:i.label,children:h("latency_test_url")}),a(Ee,{name:"latencyTestUrl",type:"text",value:n,onBlur:M})]}),c("div",{children:[a("div",{className:i.label,children:h("lang")}),a("div",{children:a(w,{options:Qe,selected:Y,onChange:s=>C.changeLanguage(s.target.value)})})]}),c("div",{children:[a("div",{className:i.label,children:h("chart_style")}),a(We,{OptionComponent:Ue,optionPropsList:qe,selectedIndex:l,onChange:J})]}),c("div",{children:[c("div",{className:i.label,children:[h("current_backend"),a("p",{children:t.baseURL})]}),a("div",{className:i.label,children:"Action"}),a(y,{start:a(ke,{size:16}),label:h("switch_backend"),onClick:H})]})]})]})}export{it as default};
